<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>视频咨询 - LAW OFFICES OF WEI & ASSOCIATES PLLC</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        .video-consultation-container {
            padding: 30px;
        }
        .video-section {
            display: flex;
            flex-direction: column;
            margin-bottom: 40px;
        }
        .video-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-top: 20px;
        }
        .video-box {
            background-color: #f0f0f0;
            width: 100%;
            max-width: 600px;
            height: 400px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2em;
            color: #666;
            margin-bottom: 20px;
        }
        .controls {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        .control-button {
            padding: 10px 15px;
            background-color: #333;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        .control-button:hover {
            background-color: #555;
        }
        .end-call {
            background-color: #e74c3c;
        }
        .end-call:hover {
            background-color: #c0392b;
        }
        .appointment-section {
            background-color: #f8f8f8;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        .appointment-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
            max-width: 600px;
            margin: 0 auto;
        }
        .date-time-selector {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        .available-slots {
            margin-top: 20px;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 10px;
        }
        .time-slot {
            padding: 10px;
            background-color: #e0e0e0;
            border: 1px solid #ccc;
            border-radius: 4px;
            text-align: center;
            cursor: pointer;
        }
        .time-slot:hover {
            background-color: #d0d0d0;
        }
        .time-slot.selected {
            background-color: #4CAF50;
            color: white;
            border-color: #4CAF50;
        }
        .time-slot.unavailable {
            background-color: #f0f0f0;
            color: #999;
            cursor: not-allowed;
            border-color: #ddd;
        }
        .instructions {
            margin-top: 30px;
            padding: 20px;
            background-color: #f9f9f9;
            border-left: 4px solid #4CAF50;
        }
        @media (max-width: 768px) {
            .date-time-selector {
                grid-template-columns: 1fr;
            }
            .video-box {
                height: 300px;
            }
        }
    </style>
</head>
<body>
    <header>
        <nav>
            <div class="nav-content">
                <h1>LAW OFFICES OF WEI & ASSOCIATES PLLC</h1>
                <div class="nav-links">
                    <a href="index.html">首页</a>
                    <a href="about.html">关于我们</a>
                    <a href="services.html">服务范围</a>
                    <a href="contact.html">联系我们</a>
                    <a href="video-consultation.html">视频咨询</a>
                    <a href="login.html" class="login-button">客户登录</a>
                    <a href="/admin" class="login-button" style="margin-left: 10px;">律师登录</a>
                </div>
            </div>
        </nav>
    </header>

    <main>
        <section class="page-header">
            <h2>视频咨询</h2>
        </section>

        <div class="video-consultation-container">
            <section class="video-section" id="videoConsultationSection" style="display: none;">
                <h3>正在进行视频咨询</h3>
                <div class="video-container">
                    <div class="video-box" id="localVideo">
                        <div id="localVideoPlaceholder">等待摄像头连接...</div>
                    </div>
                    <div class="video-box" id="remoteVideo">
                        <div id="remoteVideoPlaceholder">等待律师加入...</div>
                    </div>
                </div>
                <div class="controls">
                    <button class="control-button" id="toggleAudio">关闭麦克风</button>
                    <button class="control-button" id="toggleVideo">关闭摄像头</button>
                    <button class="control-button end-call" id="endCall">结束通话</button>
                </div>
            </section>

            <section class="appointment-section" id="appointmentSection">
                <h3>预约视频咨询</h3>
                <div class="instructions">
                    <h4>视频咨询说明</h4>
                    <p>1. 选择您方便的日期和时间，预约视频咨询。</p>
                    <p>2. 提交预约后，您将收到确认邮件，其中包含视频会议链接。</p>
                    <p>3. 在预约时间前，请确保您的设备摄像头和麦克风正常工作。</p>
                    <p>4. 建议使用Chrome、Firefox或Edge浏览器，以获得最佳体验。</p>
                    <p>5. 视频咨询费用：首次30分钟免费，之后按每30分钟$100计费。</p>
                </div>
                <form id="appointmentForm" class="appointment-form">
                    <div class="form-group">
                        <label for="name">姓名</label>
                        <input type="text" id="name" name="name" required>
                    </div>

                    <div class="form-group">
                        <label for="email">邮箱</label>
                        <input type="email" id="email" name="email" required>
                    </div>

                    <div class="form-group">
                        <label for="phone">电话</label>
                        <input type="tel" id="phone" name="phone" required>
                    </div>

                    <div class="form-group">
                        <label for="consultationType">咨询类型</label>
                        <select id="consultationType" name="consultationType" required>
                            <option value="">请选择咨询类型</option>
                            <option value="family-immigration">家庭移民</option>
                            <option value="employment-immigration">工作移民</option>
                            <option value="citizenship">入籍申请</option>
                            <option value="asylum">庇护申请</option>
                            <option value="other">其他</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="consultationDate">选择日期</label>
                        <div class="date-time-selector">
                            <input type="date" id="consultationDate" name="consultationDate" required min="">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>选择时间段</label>
                        <div class="available-slots" id="availableSlots">
                            <!-- 时间段将由JavaScript动态生成 -->
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="message">咨询内容简述</label>
                        <textarea id="message" name="message" rows="4" required></textarea>
                    </div>

                    <button type="submit">提交预约</button>
                </form>
            </section>

            <section class="join-meeting-section" id="joinMeetingSection" style="display: none;">
                <h3>加入预约的视频咨询</h3>
                <form id="joinMeetingForm" class="appointment-form">
                    <div class="form-group">
                        <label for="meetingId">咨询会议ID</label>
                        <input type="text" id="meetingId" name="meetingId" required placeholder="输入您收到的会议ID">
                    </div>
                    <button type="submit">加入会议</button>
                </form>
            </section>
        </div>
    </main>

    <footer>
        <div class="footer-content">
            <div class="footer-section">
                <h4>联系方式</h4>
                <p>电话：(123) 456-7890</p>
                <p>邮箱：contact@weilawoffices.com</p>
                <p>地址：New York, NY 10001</p>
            </div>
            <div class="footer-section">
                <h4>工作时间</h4>
                <p>周一至周五：9:00 AM - 6:00 PM</p>
                <p>周六：预约服务</p>
                <p>周日：休息</p>
            </div>
        </div>
        <div class="footer-bottom">
            <p>© 2024 LAW OFFICES OF WEI & ASSOCIATES PLLC. All rights reserved.</p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 设置日期最小值为今天
            const today = new Date();
            const tomorrow = new Date(today);
            tomorrow.setDate(tomorrow.getDate() + 1);
            
            const dateInput = document.getElementById('consultationDate');
            dateInput.min = formatDate(tomorrow);
            dateInput.value = formatDate(tomorrow);
            
            // 生成可用时间段
            generateTimeSlots();
            
            // 当日期改变时更新时间段
            dateInput.addEventListener('change', generateTimeSlots);
            
            // 表单提交处理
            document.getElementById('appointmentForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const selectedSlots = document.querySelectorAll('.time-slot.selected');
                if (selectedSlots.length === 0) {
                    alert('请选择咨询时间段');
                    return;
                }
                
                const formData = new FormData(this);
                const selectedTime = selectedSlots[0].getAttribute('data-time');
                formData.append('time', selectedTime);
                
                // 模拟表单提交
                alert('预约已提交成功！您将收到确认邮件，其中包含视频会议链接。');
                this.reset();
                document.querySelectorAll('.time-slot.selected').forEach(slot => {
                    slot.classList.remove('selected');
                });
                generateTimeSlots();
            });
            
            // 加入会议表单
            document.getElementById('joinMeetingForm').addEventListener('submit', function(e) {
                e.preventDefault();
                const meetingId = document.getElementById('meetingId').value.trim();
                if (!meetingId) {
                    alert('请输入有效的会议ID');
                    return;
                }
                
                // 显示视频界面，隐藏其他界面
                document.getElementById('appointmentSection').style.display = 'none';
                document.getElementById('joinMeetingSection').style.display = 'none';
                document.getElementById('videoConsultationSection').style.display = 'block';
                
                // 这里应该有实际的视频会议逻辑，此处仅为模拟
                simulateVideoCall();
            });
            
            // 控制按钮事件
            document.getElementById('toggleAudio').addEventListener('click', function() {
                this.textContent = this.textContent === '关闭麦克风' ? '打开麦克风' : '关闭麦克风';
            });
            
            document.getElementById('toggleVideo').addEventListener('click', function() {
                this.textContent = this.textContent === '关闭摄像头' ? '打开摄像头' : '关闭摄像头';
            });
            
            document.getElementById('endCall').addEventListener('click', function() {
                if (confirm('确定要结束通话吗？')) {
                    document.getElementById('videoConsultationSection').style.display = 'none';
                    document.getElementById('appointmentSection').style.display = 'block';
                }
            });
            
            // 检查是否登录，显示相应的会议加入区域
            const authToken = localStorage.getItem('authToken');
            if (authToken) {
                document.getElementById('joinMeetingSection').style.display = 'block';
            }
        });
        
        // 格式化日期为YYYY-MM-DD
        function formatDate(date) {
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            return `${year}-${month}-${day}`;
        }
        
        // 生成时间段
        function generateTimeSlots() {
            const container = document.getElementById('availableSlots');
            container.innerHTML = '';
            
            const date = document.getElementById('consultationDate').value;
            const day = new Date(date).getDay(); // 0为周日，1-6为周一到周六
            
            // 工作时间:周一至周五 9:00-18:00，周六 10:00-15:00，周日休息
            let startHour, endHour;
            
            if (day === 0) { // 周日
                const noSlotsMsg = document.createElement('p');
                noSlotsMsg.textContent = '周日不提供咨询服务';
                noSlotsMsg.style.gridColumn = '1 / -1';
                container.appendChild(noSlotsMsg);
                return;
            } else if (day === 6) { // 周六
                startHour = 10;
                endHour = 15;
            } else { // 周一至周五
                startHour = 9;
                endHour = 18;
            }
            
            // 随机将一些时间段标记为不可用，仅用于演示
            const unavailableSlots = [];
            const totalSlots = (endHour - startHour) * 2; // 每小时两个时间段
            
            for (let i = 0; i < Math.floor(totalSlots * 0.3); i++) {
                unavailableSlots.push(Math.floor(Math.random() * totalSlots));
            }
            
            let slotIndex = 0;
            for (let hour = startHour; hour < endHour; hour++) {
                for (let minute of ['00', '30']) {
                    const timeSlot = document.createElement('div');
                    const timeString = `${hour}:${minute}`;
                    
                    timeSlot.className = 'time-slot';
                    timeSlot.textContent = timeString;
                    timeSlot.setAttribute('data-time', timeString);
                    
                    if (unavailableSlots.includes(slotIndex)) {
                        timeSlot.classList.add('unavailable');
                        timeSlot.textContent += ' (已约)';
                    } else {
                        timeSlot.addEventListener('click', function() {
                            document.querySelectorAll('.time-slot.selected').forEach(slot => {
                                slot.classList.remove('selected');
                            });
                            this.classList.add('selected');
                        });
                    }
                    
                    container.appendChild(timeSlot);
                    slotIndex++;
                }
            }
        }
        
        // 模拟视频通话
        function simulateVideoCall() {
            // 这里应该集成实际的WebRTC或其他视频会议API
            // 此处仅为模拟效果
            
            setTimeout(() => {
                document.getElementById('localVideoPlaceholder').textContent = '您的摄像头已连接';
                
                setTimeout(() => {
                    document.getElementById('remoteVideoPlaceholder').textContent = '律师已加入会议';
                }, 3000);
            }, 1500);
        }
    </script>
</body>
</html> 